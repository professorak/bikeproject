[1] "Keeping states that make up 80% of observation weight in stXtw_group"
[1] "Removing too low wieghts states:"
[1] "Percentage of total observations removed: 0.001 %"
[1] "Removing too low demand states:"
[1] "Percentage of 0 demand states: 0.457 %"
[1] "Percentage of too low demand states truncated at 1e-5: 0.457 %"
[1] "Percentage of really high demand states truncated at 2 : 0 %"
[1] TRUE
[1] TRUE
1341.73  -11.89435  7.20246  ;; 0.0866003  -4.842006  0.08305383  ;; 0.00601668  -4.82526  0.005998652  ;; 0.0004249561  -4.824773  0.0004248658  ;; 2.915504e-05  -4.824754  2.915462e-05  ;; 1.958067e-06  -4.824753  [1] "itr:  7"
1345.832  -11.6438  7.205511  ;; 0.06852965  -4.588125  0.06628354  ;; 0.00382354  -4.573232  0.003816249  ;; 0.0002110478  -4.5729  0.0002110256  ;; 1.129383e-05  -4.57289  [1] "itr:  6"
1351.761  -12.17098  7.209903  ;; 0.04048929  -5.113056  0.03969108  ;; 0.001432649  -5.103472  0.001431624  ;; 5.344654e-05  -5.103327  5.344511e-05  ;; 1.993122e-06  -5.103325  [1] "itr:  6"
1353.329  -12.26025  7.211061  ;; 0.03769621  -5.201346  0.03700307  ;; 0.001114947  -5.192988  0.001114326  ;; 3.256693e-05  -5.192882  3.25664e-05  ;; 9.261842e-07  -5.19288  [1] "itr:  6"
1332.144  -10.81177  7.195295  ;; 0.09634377  -3.767538  0.09198079  ;; 0.006916857  -3.742217  0.006893045  ;; 0.0005236537  -3.741414  0.0005235166  ;; 3.850849e-05  -3.741384  3.850775e-05  ;; 2.762577e-06  -3.741383  [1] "itr:  7"
1343.921  -11.40615  7.20409  ;; 0.05564088  -4.353064  0.05414805  ;; 0.002624392  -4.336921  0.002620954  ;; 0.0001269556  -4.336552  0.0001269476  ;; 6.044096e-06  -4.336542  [1] "itr:  6"
    user   system  elapsed 
1220.388    0.056 1221.390 
  [1] "Intercept"             "tract_tw_fac1_1"       "tract_tw_fac1_2"      
  [4] "tract_tw_fac1_3"       "tract_tw_fac1_4"       "tract_tw_fac1_5"      
  [7] "tract_tw_fac2_1"       "tract_tw_fac2_2"       "tract_tw_fac2_3"      
 [10] "tract_tw_fac2_4"       "tract_tw_fac2_5"       "tract_tw_fac3_1"      
 [13] "tract_tw_fac3_2"       "tract_tw_fac3_3"       "tract_tw_fac3_4"      
 [16] "tract_tw_fac3_5"       "tract_tw_fac4_1"       "tract_tw_fac4_2"      
 [19] "tract_tw_fac4_3"       "tract_tw_fac4_4"       "tract_tw_fac4_5"      
 [22] "tract_tw_fac5_1"       "tract_tw_fac5_2"       "tract_tw_fac5_3"      
 [25] "tract_tw_fac5_4"       "tract_tw_fac5_5"       "tract_tw_fac6_1"      
 [28] "tract_tw_fac6_2"       "tract_tw_fac6_3"       "tract_tw_fac6_4"      
 [31] "tract_tw_fac6_5"       "tract_tw_fac7_1"       "tract_tw_fac7_2"      
 [34] "tract_tw_fac7_3"       "tract_tw_fac7_4"       "tract_tw_fac7_5"      
 [37] "tract_tw_fac8_1"       "tract_tw_fac8_2"       "tract_tw_fac8_3"      
 [40] "tract_tw_fac8_4"       "tract_tw_fac8_5"       "tract_tw_fac9_1"      
 [43] "tract_tw_fac9_2"       "tract_tw_fac9_3"       "tract_tw_fac9_4"      
 [46] "tract_tw_fac9_5"       "tract_tw_fac10_1"      "tract_tw_fac10_2"     
 [49] "tract_tw_fac10_3"      "tract_tw_fac10_4"      "tract_tw_fac10_5"     
 [52] "tract_tw_fac11_1"      "tract_tw_fac11_2"      "tract_tw_fac11_3"     
 [55] "tract_tw_fac11_4"      "tract_tw_fac11_5"      "tract_tw_fac12_1"     
 [58] "tract_tw_fac12_2"      "tract_tw_fac12_3"      "tract_tw_fac12_4"     
 [61] "tract_tw_fac12_5"      "tract_tw_fac13_1"      "tract_tw_fac13_2"     
 [64] "tract_tw_fac13_3"      "tract_tw_fac13_4"      "tract_tw_fac13_5"     
 [67] "tract_tw_fac14_1"      "tract_tw_fac14_2"      "tract_tw_fac14_3"     
 [70] "tract_tw_fac14_4"      "tract_tw_fac14_5"      "tract_tw_fac15_1"     
 [73] "tract_tw_fac15_2"      "tract_tw_fac15_3"      "tract_tw_fac15_4"     
 [76] "tract_tw_fac15_5"      "tract_tw_fac16_1"      "tract_tw_fac16_2"     
 [79] "tract_tw_fac16_3"      "tract_tw_fac16_4"      "tract_tw_fac16_5"     
 [82] "tract_tw_fac17_1"      "tract_tw_fac17_2"      "tract_tw_fac17_3"     
 [85] "tract_tw_fac17_4"      "tract_tw_fac17_5"      "tract_tw_fac18_1"     
 [88] "tract_tw_fac18_2"      "tract_tw_fac18_3"      "tract_tw_fac18_4"     
 [91] "tract_tw_fac18_5"      "tract_tw_fac19_1"      "tract_tw_fac19_2"     
 [94] "tract_tw_fac19_3"      "tract_tw_fac19_4"      "tract_tw_fac19_5"     
 [97] "tract_tw_fac20_1"      "tract_tw_fac20_2"      "tract_tw_fac20_3"     
[100] "tract_tw_fac20_4"      "tract_tw_fac20_5"      "dis_center"           
[103] "census_density"        "metro_den_on_a"        "metro_den_on_b"       
[106] "metro_den_on_c"        "metro_den_on_1"        "metro_den_on_2"       
[109] "metro_den_on_3"        "metro_den_on_4"        "metro_den_off_a"      
[112] "metro_den_off_b"       "metro_den_off_c"       "metro_den_off_1"      
[115] "metro_den_off_2"       "metro_den_off_3"       "metro_den_off_4"      
[118] "dummy_metro_den_on_a"  "dummy_metro_den_on_b"  "dummy_metro_den_on_c" 
[121] "dummy_metro_den_on_1"  "dummy_metro_den_on_2"  "dummy_metro_den_off_a"
[124] "dummy_metro_den_off_b" "dummy_metro_den_off_c" "dummy_metro_den_off_1"
[127] "dummy_metro_den_off_2" "touristlocs_den_1"     "touristlocs_den_2"    
[130] "touristlocs_den_3"     "touristlocs_den_4"     "touristlocs_den_c"    
[133] "instr_serv_lvl"        "serv_lvl_neighbours"  
  [1] "Intercept"             "tract_tw_fac1_1"       "tract_tw_fac1_2"      
  [4] "tract_tw_fac1_3"       "tract_tw_fac1_4"       "tract_tw_fac1_5"      
  [7] "tract_tw_fac2_1"       "tract_tw_fac2_2"       "tract_tw_fac2_3"      
 [10] "tract_tw_fac2_4"       "tract_tw_fac2_5"       "tract_tw_fac3_1"      
 [13] "tract_tw_fac3_2"       "tract_tw_fac3_3"       "tract_tw_fac3_4"      
 [16] "tract_tw_fac3_5"       "tract_tw_fac4_1"       "tract_tw_fac4_2"      
 [19] "tract_tw_fac4_3"       "tract_tw_fac4_4"       "tract_tw_fac4_5"      
 [22] "tract_tw_fac5_1"       "tract_tw_fac5_2"       "tract_tw_fac5_3"      
 [25] "tract_tw_fac5_4"       "tract_tw_fac5_5"       "tract_tw_fac6_1"      
 [28] "tract_tw_fac6_2"       "tract_tw_fac6_3"       "tract_tw_fac6_4"      
 [31] "tract_tw_fac6_5"       "tract_tw_fac7_1"       "tract_tw_fac7_2"      
 [34] "tract_tw_fac7_3"       "tract_tw_fac7_4"       "tract_tw_fac7_5"      
 [37] "tract_tw_fac8_1"       "tract_tw_fac8_2"       "tract_tw_fac8_3"      
 [40] "tract_tw_fac8_4"       "tract_tw_fac8_5"       "tract_tw_fac9_1"      
 [43] "tract_tw_fac9_2"       "tract_tw_fac9_3"       "tract_tw_fac9_4"      
 [46] "tract_tw_fac9_5"       "tract_tw_fac10_1"      "tract_tw_fac10_2"     
 [49] "tract_tw_fac10_3"      "tract_tw_fac10_4"      "tract_tw_fac10_5"     
 [52] "tract_tw_fac11_1"      "tract_tw_fac11_2"      "tract_tw_fac11_3"     
 [55] "tract_tw_fac11_4"      "tract_tw_fac11_5"      "tract_tw_fac12_1"     
 [58] "tract_tw_fac12_2"      "tract_tw_fac12_3"      "tract_tw_fac12_4"     
 [61] "tract_tw_fac12_5"      "tract_tw_fac13_1"      "tract_tw_fac13_2"     
 [64] "tract_tw_fac13_3"      "tract_tw_fac13_4"      "tract_tw_fac13_5"     
 [67] "tract_tw_fac14_1"      "tract_tw_fac14_2"      "tract_tw_fac14_3"     
 [70] "tract_tw_fac14_4"      "tract_tw_fac14_5"      "tract_tw_fac15_1"     
 [73] "tract_tw_fac15_2"      "tract_tw_fac15_3"      "tract_tw_fac15_4"     
 [76] "tract_tw_fac15_5"      "tract_tw_fac16_1"      "tract_tw_fac16_2"     
 [79] "tract_tw_fac16_3"      "tract_tw_fac16_4"      "tract_tw_fac16_5"     
 [82] "tract_tw_fac17_1"      "tract_tw_fac17_2"      "tract_tw_fac17_3"     
 [85] "tract_tw_fac17_4"      "tract_tw_fac17_5"      "tract_tw_fac18_1"     
 [88] "tract_tw_fac18_2"      "tract_tw_fac18_3"      "tract_tw_fac18_4"     
 [91] "tract_tw_fac18_5"      "tract_tw_fac19_1"      "tract_tw_fac19_2"     
 [94] "tract_tw_fac19_3"      "tract_tw_fac19_4"      "tract_tw_fac19_5"     
 [97] "tract_tw_fac20_1"      "tract_tw_fac20_2"      "tract_tw_fac20_3"     
[100] "tract_tw_fac20_4"      "tract_tw_fac20_5"      "dis_center"           
[103] "census_density"        "metro_den_on_a"        "metro_den_on_b"       
[106] "metro_den_on_c"        "metro_den_on_1"        "metro_den_on_2"       
[109] "metro_den_on_3"        "metro_den_on_4"        "metro_den_off_a"      
[112] "metro_den_off_b"       "metro_den_off_c"       "metro_den_off_1"      
[115] "metro_den_off_2"       "metro_den_off_3"       "metro_den_off_4"      
[118] "dummy_metro_den_on_a"  "dummy_metro_den_on_b"  "dummy_metro_den_on_c" 
[121] "dummy_metro_den_on_1"  "dummy_metro_den_on_2"  "dummy_metro_den_off_a"
[124] "dummy_metro_den_off_b" "dummy_metro_den_off_c" "dummy_metro_den_off_1"
[127] "dummy_metro_den_off_2" "touristlocs_den_1"     "touristlocs_den_2"    
[130] "touristlocs_den_3"     "touristlocs_den_4"     "touristlocs_den_c"    
[133] "instr_serv_lvl"        "serv_lvl_neighbours"  
[1] "kappa(t(Z_sqweighted) %*% Z_sqweighted): "
[1] 18997.33
[1] "kappa at theta_2 computation: 45.5356640218668"
serv_lvl 
0.935175 
Warning:  print_info_string  is not a recognized option, we try to pass it to Ipopt as  string 
[1] "params: theta, summary of delta, summary of eta"
 [1]  -2.3097750   0.0000000 -25.0012900   0.0000000   0.2101448   0.2411672
 [7]   0.2101448   0.0000000   0.0000000   0.0000000   0.0000000   0.0000000
[13]   0.0000000   4.5870590   0.1000000   0.1000000
[1] -13.683496  -5.043840  -4.305001  -4.595173  -3.712793  -1.897308
[1] -4.956786e+01 -9.025124e-12 -1.100176e-12  2.448383e+01  8.748002e-12
[6]  3.701698e+02
[1] ""
[1] "kappa at theta_2 computation: 45.5356640218668"
serv_lvl 
0.935175 
[1] "In eval_g: summary of constraints. delta constraints, eta constraint, density constraint"
[1] -2.728491e-07 -2.728735e-10 -2.355065e-11 -1.182627e-09 -1.102864e-12
[6]  1.734723e-18
[1] 0 0 0 0 0 0
[1] 9282.857
[1] ""
   user  system elapsed 
181.166   0.016 181.281 
[1] "In eval_jac_g: "
   user  system elapsed 
297.306   4.796 305.185 
[1] "In eval_hessian: "
    user   system  elapsed 
1355.632    6.813 1367.049 
[1] "params: theta, summary of delta, summary of eta"
 [1]  -2.3097750   0.0000000 -25.0012900   0.0000000   0.2101448   0.2411672
 [7]   0.2101448   0.0000000   0.0000000   0.0000000   0.0000000   0.0000000
[13]   0.0000000   4.5870590   0.1000000   0.1000000
[1] -13.683496  -5.043840  -4.305001  -4.595173  -3.712793  -1.897308
[1] -4.956786e+01 -9.025124e-12 -1.100176e-12  2.448383e+01  8.748002e-12
[6]  3.701698e+02
[1] ""
[1] "kappa at theta_2 computation: 45.5356640218668"
serv_lvl 
0.935175 
[1] "In eval_g: summary of constraints. delta constraints, eta constraint, density constraint"
[1] -2.728491e-07 -2.728735e-10 -2.355065e-11 -1.182627e-09 -1.102864e-12
[6]  1.734723e-18
[1] 0 0 0 0 0 0
[1] 9282.857
[1] ""
   user  system elapsed 
162.863   0.048 164.576 
[1] "In eval_jac_g: "
   user  system elapsed 
326.976   2.728 331.367 
[1] "In eval_hessian: "
    user   system  elapsed 
1388.785    4.729 1402.825 

******************************************************************************
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit http://projects.coin-or.org/Ipopt
******************************************************************************

This is Ipopt version 3.12.4, running with linear solver mumps.
NOTE: Other linear solvers might be more efficient (see Ipopt documentation).

Number of nonzeros in equality constraint Jacobian...:  9964936
Number of nonzeros in inequality constraint Jacobian.:        0
Number of nonzeros in Lagrangian Hessian.............:  3141225

[1] "In eval_jac_g: "
   user  system elapsed 
325.678   4.439 365.350 
[1] "In eval_jac_g: "
   user  system elapsed 
315.232   4.372 346.782 
Total number of variables............................:    35743
                     variables with only lower bounds:        0
                variables with lower and upper bounds:    35609
                     variables with only upper bounds:        0
Total number of equality constraints.................:    35735
Total number of inequality constraints...............:        0
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        0

[1] "kappa at theta_2 computation: 45.5356640218668"
serv_lvl 
0.935175 
[1] "In eval_g: summary of constraints. delta constraints, eta constraint, density constraint"
[1] 1.398266e-06 2.005188e-02 4.276111e-02 5.904395e-02 7.936584e-02
[6] 6.088790e-01
[1] 0 0 0 0 0 0
[1] 13299.28
[1] ""
   user  system elapsed 
166.536   0.310 187.437 
[1] "params: theta, summary of delta, summary of eta"
 [1]  -2.30977500   0.00000000 -25.00129000   0.00999999   0.21014480
 [6]   0.24116720   0.21014480   0.00000000   0.00000000   0.00000000
[11]   0.00000000   0.00000000   0.00000000   4.58705900   0.10000000
[16]   0.10000000
[1] -13.683496  -5.043840  -4.305001  -4.595173  -3.712793  -1.897308
[1] -4.956786e+01 -9.025124e-12 -1.100176e-12  2.448383e+01  8.748002e-12
[6]  3.701698e+02
[1] ""
[1] "In eval_hessian: "
    user   system  elapsed 
1356.334   10.298 1434.402 
iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0  1.6655397e+06 3.30e+03 1.00e+02  -1.0 0.00e+00    -  0.00e+00 0.00e+00   0 
[1] "kappa at theta_2 computation: 45.5356640218668"
 serv_lvl 
0.9393032 
[1] "In eval_g: summary of constraints. delta constraints, eta constraint, density constraint"
[1] 1.361380e-06 1.950027e-02 4.159793e-02 5.744147e-02 7.719886e-02
[6] 5.921863e-01
[1] -1.712977e-11 -9.638489e-13  4.435961e-13  2.496595e-11  6.887162e-12
[6]  2.828529e-10
[1] 13206.92
[1] ""
   user  system elapsed 
167.643   0.172 195.211 
[1] "params: theta, summary of delta, summary of eta"
 [1] -2.056863e+00  0.000000e+00 -2.640964e+01  9.701673e-03  2.701818e-01
 [6]  2.412834e-01  2.730480e-01  0.000000e+00  0.000000e+00  0.000000e+00
[11]  0.000000e+00  0.000000e+00  0.000000e+00  4.566128e+00  9.999901e-04
[16]  4.200932e-02
[1] -13.679745  -5.042019  -4.304775  -4.594728  -3.713301  -1.903407
[1] -4.970693e+01 -9.029862e-12 -1.101539e-12  2.388990e+01  8.785654e-12
[6]  3.686428e+02
[1] ""
[1] "In eval_jac_g: "
   user  system elapsed 
308.812   6.389 362.931 
[1] "In eval_hessian: "
    user   system  elapsed 
1421.526    8.635 1494.717 
   1  1.6460591e+06 3.21e+03 9.72e+01  -1.0 2.86e+02    -  8.83e-02 2.80e-02f  1 
[1] "kappa at theta_2 computation: 45.5356640218668"
 serv_lvl 
0.9515766 
[1] "In eval_g: summary of constraints. delta constraints, eta constraint, density constraint"
[1] 1.262734e-06 1.793241e-02 3.821149e-02 5.269990e-02 7.085519e-02
[6] 5.414934e-01
[1] -2.644312e-11 -4.804449e-13  8.248366e-12  1.097164e-10  4.051663e-11
[6]  1.029690e-09
[1] 12910.57
[1] ""
   user  system elapsed 
162.106   0.208 195.010 
[1] "params: theta, summary of delta, summary of eta"
 [1] -1.149830e+00  0.000000e+00 -3.147661e+01  8.725547e-03  3.617469e-01
 [6]  2.417504e-01  4.293032e-01  0.000000e+00  0.000000e+00  0.000000e+00
[11]  0.000000e+00  0.000000e+00  0.000000e+00  4.496637e+00  7.421515e-04
[16]  4.200833e-04
[1] -13.709759  -5.036722  -4.303364  -4.593332  -3.714070  -1.916071
[1] -5.019719e+01 -9.345180e-12 -9.429863e-13  2.181887e+01  8.776715e-12
[6]  3.641054e+02
[1] ""
[1] "In eval_jac_g: "
   user  system elapsed 
338.341   7.109 432.072 
[1] "In eval_hessian: "
    user   system  elapsed 
1358.420    8.172 1413.537 
   2  1.5889138e+06 2.91e+03 2.00e+02  -1.0 3.03e+02    -  5.77e-01 9.24e-02f  1 Nhj 
[1] "kappa at theta_2 computation: 45.5356640218668"
serv_lvl 
1.066813 
[1] "In eval_g: summary of constraints. delta constraints, eta constraint, density constraint"
[1] 1.056208e-06 1.582306e-02 3.288520e-02 4.443633e-02 5.974300e-02
[6] 5.262363e-01
[1] -3.697238e-10 -1.449432e-11 -3.150132e-12 -3.543491e-11 -4.005399e-13
[6]  7.649330e-12
[1] 10290.02
[1] ""
   user  system elapsed 
175.484   0.505 191.152 
[1] "params: theta, summary of delta, summary of eta"
 [1]  1.006014e+01  0.000000e+00 -9.625668e+01  8.724557e-05  1.095868e+00
 [6]  2.474725e-01  1.613529e+00  0.000000e+00  0.000000e+00  0.000000e+00
[11]  0.000000e+00  0.000000e+00  0.000000e+00  4.124682e+00  8.486153e-04
[16]  4.186305e-03
[1] -14.145410  -4.985306  -4.271532  -4.556484  -3.697089  -1.743593
[1] -7.991784e+01 -4.027195e-12  1.302695e-12  2.430679e+00  5.580791e-12
[6]  3.212580e+02
[1] ""
[1] "In eval_jac_g: "
   user  system elapsed 
325.886   9.400 361.453 
[1] "In eval_hessian: "
    user   system  elapsed 
1546.966   10.817 1584.053 
   3  1.3094529e+06 2.90e+02 2.31e+04  -1.0 2.99e+02    -  3.58e-01 9.00e-01f  1 
[1] "kappa at theta_2 computation: 45.5356640218668"
serv_lvl 
1.062322 
[1] "In eval_g: summary of constraints. delta constraints, eta constraint, density constraint"
[1] 9.832625e-07 1.472662e-02 3.060804e-02 4.135951e-02 5.560661e-02
[6] 4.898142e-01
[1] -5.944401e-11 -4.825321e-13  1.685021e-12  1.734916e-11  8.865342e-12
[6]  3.613860e-10
[1] 10269.73
[1] ""
   user  system elapsed 
191.848   0.236 204.705 
[1] "params: theta, summary of delta, summary of eta"
 [1]  9.919841e+00  0.000000e+00 -9.515655e+01  8.625557e-07  1.100700e+00
 [6]  2.477267e-01  1.623787e+00  0.000000e+00  0.000000e+00  0.000000e+00
[11]  0.000000e+00  0.000000e+00  0.000000e+00  4.201219e+00  8.185922e-04
[16]  3.926070e-03
[1] -14.162411  -5.003277  -4.289048  -4.573922  -3.714549  -1.761970
[1] -7.822115e+01 -3.993632e-12  1.014861e-12  2.234376e+00  5.225613e-12
[6]  3.205756e+02
[1] ""
[1] "In eval_jac_g: "
   user  system elapsed 
379.294   7.563 397.101 
[1] "In eval_hessian: "
    user   system  elapsed 
1543.085    9.768 1576.648 
   4  1.3077462e+06 2.70e+02 2.13e+04  -1.0 6.70e+01    -  1.92e-01 7.00e-02f  1 
[1] "kappa at theta_2 computation: 45.5356640218668"
serv_lvl 
1.004758 
[1] "In eval_g: summary of constraints. delta constraints, eta constraint, density constraint"
[1] 3.416359e-07 3.695939e-03 7.510166e-03 9.641544e-03 1.330637e-02
[6] 9.022867e-02
[1] -3.155805e-10 -1.407408e-11 -2.259360e-12 -3.058196e-11  1.363695e-13
[6]  1.207026e-11
[1] 10000
[1] ""
   user  system elapsed 
177.218   0.153 185.352 
[1] "params: theta, summary of delta, summary of eta"
 [1]  4.531317e+00  0.000000e+00 -5.954118e+01  1.133341e-04  1.215653e+00
 [6]  2.363996e-01  1.844781e+00  0.000000e+00  0.000000e+00  0.000000e+00
[11]  0.000000e+00  0.000000e+00  0.000000e+00  5.733358e+00  5.045563e-04
[16]  1.323068e-03
[1] -14.326320  -5.176009  -4.459396  -4.749920  -3.892404  -1.973643
[1] -6.553966e+01 -5.106766e-12  1.410731e-12 -4.507848e-01  7.707659e-12
[6]  3.084584e+02
[1] ""
[1] "In eval_jac_g: "
   user  system elapsed 
358.501   6.196 374.965 
[1] "In eval_hessian: "
