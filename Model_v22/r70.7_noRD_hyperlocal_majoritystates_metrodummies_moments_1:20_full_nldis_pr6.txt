[1] "Keeping states that make up 80% of observation weight in stXtw_group"
[1] "Removing too low wieghts states:"
[1] "Percentage of total observations removed: 0.001 %"
[1] "Removing too low demand states:"
[1] "Percentage of 0 demand states: 0.457 %"
[1] "Percentage of too low demand states truncated at 1e-5: 0.457 %"
[1] "Percentage of really high demand states truncated at 2 : 0 %"
[1] TRUE
[1] TRUE
1341.73  -11.89435  7.20246  ;; 0.0866003  -4.842006  0.08305383  ;; 0.00601668  -4.82526  0.005998652  ;; 0.0004249561  -4.824773  0.0004248658  ;; 2.915504e-05  -4.824754  2.915462e-05  ;; 1.958067e-06  -4.824753  [1] "itr:  7"
1345.832  -11.6438  7.205511  ;; 0.06852965  -4.588125  0.06628354  ;; 0.00382354  -4.573232  0.003816249  ;; 0.0002110478  -4.5729  0.0002110256  ;; 1.129383e-05  -4.57289  [1] "itr:  6"
1351.761  -12.17098  7.209903  ;; 0.04048929  -5.113056  0.03969108  ;; 0.001432649  -5.103472  0.001431624  ;; 5.344654e-05  -5.103327  5.344511e-05  ;; 1.993122e-06  -5.103325  [1] "itr:  6"
1353.329  -12.26025  7.211061  ;; 0.03769621  -5.201346  0.03700307  ;; 0.001114947  -5.192988  0.001114326  ;; 3.256693e-05  -5.192882  3.25664e-05  ;; 9.261842e-07  -5.19288  [1] "itr:  6"
1332.144  -10.81177  7.195295  ;; 0.09634377  -3.767538  0.09198079  ;; 0.006916857  -3.742217  0.006893045  ;; 0.0005236537  -3.741414  0.0005235166  ;; 3.850849e-05  -3.741384  3.850775e-05  ;; 2.762577e-06  -3.741383  [1] "itr:  7"
1343.921  -11.40615  7.20409  ;; 0.05564088  -4.353064  0.05414805  ;; 0.002624392  -4.336921  0.002620954  ;; 0.0001269556  -4.336552  0.0001269476  ;; 6.044096e-06  -4.336542  [1] "itr:  6"
    user   system  elapsed 
1090.921    0.051 1091.831 
  [1] "Intercept"             "tract_tw_fac1_1"       "tract_tw_fac1_2"      
  [4] "tract_tw_fac1_3"       "tract_tw_fac1_4"       "tract_tw_fac1_5"      
  [7] "tract_tw_fac2_1"       "tract_tw_fac2_2"       "tract_tw_fac2_3"      
 [10] "tract_tw_fac2_4"       "tract_tw_fac2_5"       "tract_tw_fac3_1"      
 [13] "tract_tw_fac3_2"       "tract_tw_fac3_3"       "tract_tw_fac3_4"      
 [16] "tract_tw_fac3_5"       "tract_tw_fac4_1"       "tract_tw_fac4_2"      
 [19] "tract_tw_fac4_3"       "tract_tw_fac4_4"       "tract_tw_fac4_5"      
 [22] "tract_tw_fac5_1"       "tract_tw_fac5_2"       "tract_tw_fac5_3"      
 [25] "tract_tw_fac5_4"       "tract_tw_fac5_5"       "tract_tw_fac6_1"      
 [28] "tract_tw_fac6_2"       "tract_tw_fac6_3"       "tract_tw_fac6_4"      
 [31] "tract_tw_fac6_5"       "tract_tw_fac7_1"       "tract_tw_fac7_2"      
 [34] "tract_tw_fac7_3"       "tract_tw_fac7_4"       "tract_tw_fac7_5"      
 [37] "tract_tw_fac8_1"       "tract_tw_fac8_2"       "tract_tw_fac8_3"      
 [40] "tract_tw_fac8_4"       "tract_tw_fac8_5"       "tract_tw_fac9_1"      
 [43] "tract_tw_fac9_2"       "tract_tw_fac9_3"       "tract_tw_fac9_4"      
 [46] "tract_tw_fac9_5"       "tract_tw_fac10_1"      "tract_tw_fac10_2"     
 [49] "tract_tw_fac10_3"      "tract_tw_fac10_4"      "tract_tw_fac10_5"     
 [52] "tract_tw_fac11_1"      "tract_tw_fac11_2"      "tract_tw_fac11_3"     
 [55] "tract_tw_fac11_4"      "tract_tw_fac11_5"      "tract_tw_fac12_1"     
 [58] "tract_tw_fac12_2"      "tract_tw_fac12_3"      "tract_tw_fac12_4"     
 [61] "tract_tw_fac12_5"      "tract_tw_fac13_1"      "tract_tw_fac13_2"     
 [64] "tract_tw_fac13_3"      "tract_tw_fac13_4"      "tract_tw_fac13_5"     
 [67] "tract_tw_fac14_1"      "tract_tw_fac14_2"      "tract_tw_fac14_3"     
 [70] "tract_tw_fac14_4"      "tract_tw_fac14_5"      "tract_tw_fac15_1"     
 [73] "tract_tw_fac15_2"      "tract_tw_fac15_3"      "tract_tw_fac15_4"     
 [76] "tract_tw_fac15_5"      "tract_tw_fac16_1"      "tract_tw_fac16_2"     
 [79] "tract_tw_fac16_3"      "tract_tw_fac16_4"      "tract_tw_fac16_5"     
 [82] "tract_tw_fac17_1"      "tract_tw_fac17_2"      "tract_tw_fac17_3"     
 [85] "tract_tw_fac17_4"      "tract_tw_fac17_5"      "tract_tw_fac18_1"     
 [88] "tract_tw_fac18_2"      "tract_tw_fac18_3"      "tract_tw_fac18_4"     
 [91] "tract_tw_fac18_5"      "tract_tw_fac19_1"      "tract_tw_fac19_2"     
 [94] "tract_tw_fac19_3"      "tract_tw_fac19_4"      "tract_tw_fac19_5"     
 [97] "tract_tw_fac20_1"      "tract_tw_fac20_2"      "tract_tw_fac20_3"     
[100] "tract_tw_fac20_4"      "tract_tw_fac20_5"      "dis_center"           
[103] "census_density"        "metro_den_on_a"        "metro_den_on_b"       
[106] "metro_den_on_c"        "metro_den_on_1"        "metro_den_on_2"       
[109] "metro_den_on_3"        "metro_den_on_4"        "metro_den_off_a"      
[112] "metro_den_off_b"       "metro_den_off_c"       "metro_den_off_1"      
[115] "metro_den_off_2"       "metro_den_off_3"       "metro_den_off_4"      
[118] "dummy_metro_den_on_a"  "dummy_metro_den_on_b"  "dummy_metro_den_on_c" 
[121] "dummy_metro_den_on_1"  "dummy_metro_den_on_2"  "dummy_metro_den_off_a"
[124] "dummy_metro_den_off_b" "dummy_metro_den_off_c" "dummy_metro_den_off_1"
[127] "dummy_metro_den_off_2" "touristlocs_den_1"     "touristlocs_den_2"    
[130] "touristlocs_den_3"     "touristlocs_den_4"     "touristlocs_den_c"    
  [1] "Intercept"             "tract_tw_fac1_1"       "tract_tw_fac1_2"      
  [4] "tract_tw_fac1_3"       "tract_tw_fac1_4"       "tract_tw_fac1_5"      
  [7] "tract_tw_fac2_1"       "tract_tw_fac2_2"       "tract_tw_fac2_3"      
 [10] "tract_tw_fac2_4"       "tract_tw_fac2_5"       "tract_tw_fac3_1"      
 [13] "tract_tw_fac3_2"       "tract_tw_fac3_3"       "tract_tw_fac3_4"      
 [16] "tract_tw_fac3_5"       "tract_tw_fac4_1"       "tract_tw_fac4_2"      
 [19] "tract_tw_fac4_3"       "tract_tw_fac4_4"       "tract_tw_fac4_5"      
 [22] "tract_tw_fac5_1"       "tract_tw_fac5_2"       "tract_tw_fac5_3"      
 [25] "tract_tw_fac5_4"       "tract_tw_fac5_5"       "tract_tw_fac6_1"      
 [28] "tract_tw_fac6_2"       "tract_tw_fac6_3"       "tract_tw_fac6_4"      
 [31] "tract_tw_fac6_5"       "tract_tw_fac7_1"       "tract_tw_fac7_2"      
 [34] "tract_tw_fac7_3"       "tract_tw_fac7_4"       "tract_tw_fac7_5"      
 [37] "tract_tw_fac8_1"       "tract_tw_fac8_2"       "tract_tw_fac8_3"      
 [40] "tract_tw_fac8_4"       "tract_tw_fac8_5"       "tract_tw_fac9_1"      
 [43] "tract_tw_fac9_2"       "tract_tw_fac9_3"       "tract_tw_fac9_4"      
 [46] "tract_tw_fac9_5"       "tract_tw_fac10_1"      "tract_tw_fac10_2"     
 [49] "tract_tw_fac10_3"      "tract_tw_fac10_4"      "tract_tw_fac10_5"     
 [52] "tract_tw_fac11_1"      "tract_tw_fac11_2"      "tract_tw_fac11_3"     
 [55] "tract_tw_fac11_4"      "tract_tw_fac11_5"      "tract_tw_fac12_1"     
 [58] "tract_tw_fac12_2"      "tract_tw_fac12_3"      "tract_tw_fac12_4"     
 [61] "tract_tw_fac12_5"      "tract_tw_fac13_1"      "tract_tw_fac13_2"     
 [64] "tract_tw_fac13_3"      "tract_tw_fac13_4"      "tract_tw_fac13_5"     
 [67] "tract_tw_fac14_1"      "tract_tw_fac14_2"      "tract_tw_fac14_3"     
 [70] "tract_tw_fac14_4"      "tract_tw_fac14_5"      "tract_tw_fac15_1"     
 [73] "tract_tw_fac15_2"      "tract_tw_fac15_3"      "tract_tw_fac15_4"     
 [76] "tract_tw_fac15_5"      "tract_tw_fac16_1"      "tract_tw_fac16_2"     
 [79] "tract_tw_fac16_3"      "tract_tw_fac16_4"      "tract_tw_fac16_5"     
 [82] "tract_tw_fac17_1"      "tract_tw_fac17_2"      "tract_tw_fac17_3"     
 [85] "tract_tw_fac17_4"      "tract_tw_fac17_5"      "tract_tw_fac18_1"     
 [88] "tract_tw_fac18_2"      "tract_tw_fac18_3"      "tract_tw_fac18_4"     
 [91] "tract_tw_fac18_5"      "tract_tw_fac19_1"      "tract_tw_fac19_2"     
 [94] "tract_tw_fac19_3"      "tract_tw_fac19_4"      "tract_tw_fac19_5"     
 [97] "tract_tw_fac20_1"      "tract_tw_fac20_2"      "tract_tw_fac20_3"     
[100] "tract_tw_fac20_4"      "tract_tw_fac20_5"      "dis_center"           
[103] "census_density"        "metro_den_on_a"        "metro_den_on_b"       
[106] "metro_den_on_c"        "metro_den_on_1"        "metro_den_on_2"       
[109] "metro_den_on_3"        "metro_den_on_4"        "metro_den_off_a"      
[112] "metro_den_off_b"       "metro_den_off_c"       "metro_den_off_1"      
[115] "metro_den_off_2"       "metro_den_off_3"       "metro_den_off_4"      
[118] "dummy_metro_den_on_a"  "dummy_metro_den_on_b"  "dummy_metro_den_on_c" 
[121] "dummy_metro_den_on_1"  "dummy_metro_den_on_2"  "dummy_metro_den_off_a"
[124] "dummy_metro_den_off_b" "dummy_metro_den_off_c" "dummy_metro_den_off_1"
[127] "dummy_metro_den_off_2" "touristlocs_den_1"     "touristlocs_den_2"    
[130] "touristlocs_den_3"     "touristlocs_den_4"     "touristlocs_den_c"    
[1] "kappa(t(Z_sqweighted) %*% Z_sqweighted): "
[1] 17984.29
[1] "kappa at theta_2 computation: 9.47219905391775"
numeric(0)
Warning:  print_info_string  is not a recognized option, we try to pass it to Ipopt as  string 
[1] "params: theta, summary of delta, summary of eta"
 [1]  -2.3097750   0.0000000 -25.0012900   0.0000000   0.2101448   0.2411672
 [7]   0.2101448   0.0000000   0.0000000   0.0000000   0.0000000   0.0000000
[13]   0.0000000   4.5870590   0.1000000   0.1000000
[1] -13.683496  -5.043840  -4.305001  -4.595173  -3.712793  -1.897308
[1] -4.160828e+01 -1.531220e-12  1.045193e-12  2.166465e+01  4.519142e-12
[6]  3.089703e+02
[1] ""
[1] "kappa at theta_2 computation: 9.47219905391775"
numeric(0)
[1] "In eval_g: summary of constraints. delta constraints, eta constraint, density constraint"
[1] -2.728491e-07 -2.728735e-10 -2.355065e-11 -1.182627e-09 -1.102864e-12
[6]  1.734723e-18
[1] 0 0 0 0 0 0
[1] 9282.857
[1] ""
   user  system elapsed 
151.352   0.052 151.452 
[1] "In eval_jac_g: "
   user  system elapsed 
311.995   3.844 315.999 
[1] "In eval_hessian: "
    user   system  elapsed 
1379.248    4.833 1393.425 
[1] "params: theta, summary of delta, summary of eta"
 [1]  -2.3097750   0.0000000 -25.0012900   0.0000000   0.2101448   0.2411672
 [7]   0.2101448   0.0000000   0.0000000   0.0000000   0.0000000   0.0000000
[13]   0.0000000   4.5870590   0.1000000   0.1000000
[1] -13.683496  -5.043840  -4.305001  -4.595173  -3.712793  -1.897308
[1] -4.160828e+01 -1.531220e-12  1.045193e-12  2.166465e+01  4.519142e-12
[6]  3.089703e+02
[1] ""
[1] "kappa at theta_2 computation: 9.47219905391775"
numeric(0)
[1] "In eval_g: summary of constraints. delta constraints, eta constraint, density constraint"
[1] -2.728491e-07 -2.728735e-10 -2.355065e-11 -1.182627e-09 -1.102864e-12
[6]  1.734723e-18
[1] 0 0 0 0 0 0
[1] 9282.857
[1] ""
   user  system elapsed 
156.427   0.100 158.245 
[1] "In eval_jac_g: "
   user  system elapsed 
328.066   3.020 332.704 
[1] "In eval_hessian: "
    user   system  elapsed 
1401.915    4.731 1409.339 

******************************************************************************
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit http://projects.coin-or.org/Ipopt
******************************************************************************

This is Ipopt version 3.12.4, running with linear solver mumps.
NOTE: Other linear solvers might be more efficient (see Ipopt documentation).

Number of nonzeros in equality constraint Jacobian...:  9893744
Number of nonzeros in inequality constraint Jacobian.:        0
Number of nonzeros in Lagrangian Hessian.............:  3140693

[1] "In eval_jac_g: "
   user  system elapsed 
305.694   4.271 339.991 
[1] "In eval_jac_g: "
   user  system elapsed 
314.475   2.841 323.077 
Total number of variables............................:    35741
                     variables with only lower bounds:        0
                variables with lower and upper bounds:    35609
                     variables with only upper bounds:        0
Total number of equality constraints.................:    35733
Total number of inequality constraints...............:        0
        inequality constraints with only lower bounds:        0
   inequality constraints with lower and upper bounds:        0
        inequality constraints with only upper bounds:        0

[1] "kappa at theta_2 computation: 9.47219905391775"
numeric(0)
[1] "In eval_g: summary of constraints. delta constraints, eta constraint, density constraint"
[1] 1.398266e-06 2.005188e-02 4.276111e-02 5.904395e-02 7.936584e-02
[6] 6.088790e-01
[1] 0 0 0 0 0 0
[1] 13299.28
[1] ""
   user  system elapsed 
181.681   0.336 190.981 
[1] "params: theta, summary of delta, summary of eta"
 [1]  -2.30977500   0.00000000 -25.00129000   0.00999999   0.21014480
 [6]   0.24116720   0.21014480   0.00000000   0.00000000   0.00000000
[11]   0.00000000   0.00000000   0.00000000   4.58705900   0.10000000
[16]   0.10000000
[1] -13.683496  -5.043840  -4.305001  -4.595173  -3.712793  -1.897308
[1] -4.160828e+01 -1.531220e-12  1.045193e-12  2.166465e+01  4.519142e-12
[6]  3.089703e+02
[1] ""
[1] "In eval_hessian: "
    user   system  elapsed 
1359.608   11.902 1482.017 
iter    objective    inf_pr   inf_du lg(mu)  ||d||  lg(rg) alpha_du alpha_pr  ls
   0  3.2726913e+05 3.30e+03 1.00e+02  -1.0 0.00e+00    -  0.00e+00 0.00e+00   0 
[1] "kappa at theta_2 computation: 9.47219905391775"
numeric(0)
[1] "In eval_g: summary of constraints. delta constraints, eta constraint, density constraint"
[1] 1.254060e-06 1.792264e-02 3.822497e-02 5.276933e-02 7.089848e-02
[6] 5.435883e-01
[1] -2.195658e-12 -3.857179e-13  5.083784e-13  1.571862e-11  3.994546e-12
[6]  1.719537e-10
[1] 12935.72
[1] ""
   user  system elapsed 
157.915   0.674 187.423 
[1] "params: theta, summary of delta, summary of eta"
 [1] -1.919351e+00  0.000000e+00 -2.752231e+01  8.623395e-03  3.112246e-01
 [6]  2.439305e-01  4.040611e-01  0.000000e+00  0.000000e+00  0.000000e+00
[11]  0.000000e+00  0.000000e+00  0.000000e+00  4.634643e+00  9.108230e-02
[16]  9.999901e-04
[1] -13.691475  -5.035894  -4.299984  -4.590381  -3.710898  -1.902835
[1] -3.711806e+01 -1.447574e-12  9.879653e-13  1.954352e+01  4.537934e-12
[6]  2.812253e+02
[1] ""
[1] "In eval_jac_g: "
   user  system elapsed 
324.345  12.751 473.691 
[1] "In eval_hessian: "
    user   system  elapsed 
1341.491    7.790 1426.261 
   1  2.7750394e+05 2.94e+03 1.11e+02  -1.0 2.52e+02    -  1.11e-01 1.10e-01f  1 
[1] "kappa at theta_2 computation: 9.47219905391775"
numeric(0)
[1] "In eval_g: summary of constraints. delta constraints, eta constraint, density constraint"
[1] 9.635357e-07 1.298030e-02 2.762783e-02 3.796292e-02 5.109002e-02
[6] 3.836649e-01
[1] -1.750067e-10 -2.469731e-12 -6.107392e-13 -1.185429e-11  5.791098e-13
[6]  9.394442e-11
[1] 11975.79
[1] ""
   user  system elapsed 
148.919   0.353 159.679 
[1] "params: theta, summary of delta, summary of eta"
 [1] -4.170118e-01  0.000000e+00 -3.740317e+01  4.950913e-03  5.746835e-01
 [6]  2.521331e-01  8.081920e-01  0.000000e+00  0.000000e+00  0.000000e+00
[11]  0.000000e+00  0.000000e+00  0.000000e+00  4.760721e+00  9.108131e-04
[16]  1.437139e-02
[1] -13.754811  -4.998527  -4.272660  -4.561819  -3.689563  -1.888547
[1] -3.702108e+01 -1.315712e-12  9.646614e-13  1.371641e+01  4.006096e-12
[6]  2.048396e+02
[1] ""
[1] "In eval_jac_g: "
   user  system elapsed 
305.013  12.352 430.390 
[1] "In eval_hessian: "
    user   system  elapsed 
1371.704   13.315 1489.194 
   2  1.6982066e+05 1.98e+03 8.09e+02  -1.0 2.34e+02    -  3.43e-01 3.27e-01f  1 Nhj 
[1] "kappa at theta_2 computation: 9.47219905391775"
numeric(0)
[1] "In eval_g: summary of constraints. delta constraints, eta constraint, density constraint"
[1] 8.819616e-07 1.016621e-02 2.134352e-02 2.883966e-02 3.901581e-02
[6] 2.833388e-01
[1] -1.590622e-10 -6.735092e-13  8.556884e-14  2.110083e-11  1.744543e-12
[6]  3.096317e-10
[1] 11226.85
[1] ""
   user  system elapsed 
153.269   0.206 159.353 
[1] "params: theta, summary of delta, summary of eta"
 [1]   2.428924666   0.000000000 -57.138717496   0.002068661   0.672753529
 [6]   0.260526624   1.008577202   0.000000000   0.000000000   0.000000000
[11]   0.000000000   0.000000000   0.000000000   4.870276978   0.013399234
[16]   0.000143704
[1] -13.820070  -4.931724  -4.208365  -4.498153  -3.632356  -1.771331
[1] -3.669516e+01 -1.715269e-12  1.040956e-12  8.533595e+00  3.624847e-12
[6]  1.286790e+02
[1] ""
[1] "In eval_jac_g: "
   user  system elapsed 
294.576   6.702 327.680 
[1] "In eval_hessian: "
    user   system  elapsed 
1445.029   12.413 1505.690 
   3  1.0619699e+05 1.23e+03 1.07e+02  -1.0 2.01e+02    -  6.21e-01 3.79e-01f  1 
[1] "kappa at theta_2 computation: 9.47219905391775"
numeric(0)
[1] "In eval_g: summary of constraints. delta constraints, eta constraint, density constraint"
[1] 5.661820e-07 6.399669e-03 1.343179e-02 1.811379e-02 2.451018e-02
[6] 1.790809e-01
[1] -1.031089e-11 -1.162655e-12 -1.223692e-14  1.099418e-11  3.397246e-12
[6]  1.280824e-10
[1] 10734.88
[1] ""
   user  system elapsed 
186.362   0.100 188.106 
[1] "params: theta, summary of delta, summary of eta"
 [1]  1.815743e+00  0.000000e+00 -5.981913e+01  1.513385e-04  7.316598e-01
 [6]  2.666172e-01  1.104520e+00  0.000000e+00  0.000000e+00  0.000000e+00
[11]  0.000000e+00  0.000000e+00  0.000000e+00  5.039392e+00  1.339824e-04
[16]  2.100617e-03
[1] -13.797632  -4.829763  -4.109403  -4.399241  -3.534740  -1.646537
[1] -4.208541e+01 -1.753974e-12  5.803122e-13  4.926282e+00  3.057055e-12
[6]  7.572951e+01
[1] ""
[1] "In eval_jac_g: "
   user  system elapsed 
364.562   5.494 382.147 
[1] "In eval_hessian: "
    user   system  elapsed 
1539.657   13.007 1603.245 
   4  8.0014410e+04 7.35e+02 9.04e+02  -1.0 1.43e+02    -  9.66e-01 4.01e-01f  1 
[1] "kappa at theta_2 computation: 9.47219905391775"
numeric(0)
[1] "In eval_g: summary of constraints. delta constraints, eta constraint, density constraint"
[1] 5.379873e-07 6.081027e-03 1.276239e-02 1.721086e-02 2.328936e-02
[6] 1.701496e-01
[1] -1.129222e-10 -1.614486e-12 -3.416518e-13  5.885589e-12  1.827360e-12
[6]  1.233298e-10
[1] 10698.07
[1] ""
   user  system elapsed 
194.113   0.085 196.963 
[1] "params: theta, summary of delta, summary of eta"
 [1]  1.476221e+00  0.000000e+00 -5.875085e+01  1.503485e-06  7.335993e-01
 [6]  2.671890e-01  1.108224e+00  0.000000e+00  0.000000e+00  0.000000e+00
[11]  0.000000e+00  0.000000e+00  0.000000e+00  5.056915e+00  2.181339e-04
[16]  2.123490e-03
[1] -13.784182  -4.811600  -4.090411  -4.380644  -3.515780  -1.626484
[1] -4.249915e+01 -1.762694e-12  5.677672e-13  4.627753e+00  3.030128e-12
[6]  7.241934e+01
[1] ""
[1] "In eval_jac_g: "
   user  system elapsed 
332.822   5.713 344.885 
[1] "In eval_hessian: "
